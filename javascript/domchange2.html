<!doctype html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>dom变化测试</title>
    <script src="jquery-1.8.0.js"></script>
    <script src="wind-all-0.7.3.js"></script>
</head>
<body>
    <button>heihei</button>
    <p>1</p>
    <pre></pre>
    <script>
        (function(){
           var onEvent2 = function (target, eventName) {
                return Wind.Async.Task.create(function (t) {
                    target.one(eventName, function(ev){
                        console.log('sssss', ev);
                        t.complete("success", ev);
                    });
                });
            };

            var task = eval(Wind.compile("async", function () {
                $('p').bind('DOMSubtreeModified',function(e){
                    $('pre').append('label changed on jquery bind\r\n'); 
                });

                setTimeout(function(){
                    $('p').text(Math.random());
                }, 1000);

                $await(onEvent2($('p'), "DOMSubtreeModified"));
                $('pre').append('label changed on windjs\r\n'); 
            }));
            task().start();

        })();
    </script>
</body>
</html>

